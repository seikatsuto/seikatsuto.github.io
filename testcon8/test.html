<!DOCTYPE html>
<html>
<body>
<button onclick="send()">送信</button>
<pre id="out"></pre>

<script>
const USER="seikatsuto";
const REPO="testcon8";
//const TOKEN="ghp_あなたのトークン";
//const TOKEN = "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";   // ghp_xxxxxxxxxxxxxxxxxトークン
const TOKEN = "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"; //
function toBase64(str){
  return btoa(unescape(encodeURIComponent(str)));
}

async function send(){
  const out=document.getElementById("out");
  out.textContent="送信中...\n";

  try{
    const text="日本語テスト "+new Date();
    const content=toBase64(text);

    const res=await fetch(
      `https://api.github.com/repos/${USER}/${REPO}/contents/kiosk_test.txt`,
      {
        method:"PUT",
        headers:{
          "Authorization":"token "+TOKEN,
          "Content-Type":"application/json"
        },
        body:JSON.stringify({
          message:"kiosk test",
          content:content
        })
      }
    );

    out.textContent+="status="+res.status+"\n";
    out.textContent+=await res.text();

  }catch(e){
    out.textContent+="エラー:\n"+e;
  }
}
</script>
</body>
</html>

