<!DOCTYPE html>
<html lang="ja">
<body>
<button onclick="send()">GitHubへ送信</button>
<pre id="out"></pre>

<script>
const USER = "seikatsuto";
const REPO = "seikatsuto.github.io";
const TOKEN = "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";

function toBase64(str){
  return btoa(unescape(encodeURIComponent(str)));
}

async function send(){
  const out = document.getElementById("out");
  out.textContent = "送信中...\n";

  const text = "KIOSK TEST " + new Date();
  const content = toBase64(text);

  const res = await fetch(
    `https://api.github.com/repos/${USER}/${REPO}/contents/testcon8/kiosk_test.txt`,
    {
      method: "PUT",
      headers: {
        "Authorization": "token " + TOKEN,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        message: "kiosk test",
        content: content
      })
    }
  );

  out.textContent += "status=" + res.status + "\n";
  out.textContent += await res.text();
}
</script>
</body>
</html>
